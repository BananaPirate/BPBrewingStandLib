/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */


plugins {
	// Apply the java-library plugin to add support for Java Library
	id 'java-library'
	id 'eclipse'
	id 'com.github.johnrengelman.shadow' version '6.0.0'
}

repositories{
	jcenter()
	mavenCentral()
	maven { url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/' }
	maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
	maven { url "https://jitpack.io" }
}

dependencies{
	compileOnly 'org.spigotmc:spigot-api:1.16.1-R0.1-SNAPSHOT'
	compile 'com.github.BananaPirate:BPUtils:master'
}


apply from: "devServerAutomation.gradle"

processResources {
	from(sourceSets.main.resources.srcDirs) {
		expand ('plugin_version': project.ext.plugin_version, 'api_version': project.ext.api_version)
		include 'plugin.yml'
	}
}



shadowJar{
	dependencies {
		include(dependency('com.github.BananaPirate:BPUtils:master'))
	}
	archiveName = "${plugin_name}.jar"
	relocate "org.sijbesma.bp.utils", "org.sijbesma.bp.${plugin_name}.utils"
}




task compilePlugin{
	group = "Spigot plugin"
	description = "Compiles the plugin and copies it to the dev server"
	dependsOn shadowJar
	doLast{
		copy{
			from "/build/libs/${plugin_name}.jar"
			into "${dev_server_folder}/${api_version}/plugins"
		}
	}
}





task run{
	group = "Spigot plugin"
	description = "all in one"
	dependsOn clean, compilePlugin, setupDevServer, reloadDevServer, startDevServer
}


